#include <stdio.h>
#include <string.h>

char *encrypt(char *message, char *key, int shift) {
    size_t msg_len = strlen(message);
    size_t key_len = strlen(key);
    for (int i = 0; i < msg_len; i++) {
        message[i] ^= key[i % key_len];
    }
    for (int i = 0; i < msg_len; i++) {
        message[i] = (message[i] + shift) % 256;
    }
    for (int i = 0; i < msg_len / 2; i++) {
        char temp = message[i];
        message[i] = message[msg_len - i - 1];
        message[msg_len - i - 1] = temp;
    }
    return message;
}

int main() {
    char message[] = "This is the secret message!";
    char key[] = "ComplexKey";
    int shift = 13;
    printf("%s\n", encrypt(message, key, shift));
    return 0;
}
